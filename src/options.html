<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZDFTranslate 设置</title>
  <link rel="stylesheet" href="styles/options.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="logo-container">
        <svg viewBox="0 0 128 128" width="64" height="64">
          <defs>
            <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#60a5fa"/>
              <stop offset="100%" style="stop-color:#2563eb"/>
            </linearGradient>
          </defs>
          <rect width="128" height="128" rx="24" fill="url(#logoGrad)"/>
          <text x="28" y="88" fill="white" font-family="Arial, sans-serif" font-weight="bold" font-size="56">Z</text>
          <text x="72" y="88" fill="white" font-family="Arial, sans-serif" font-weight="bold" font-size="56">T</text>
          <path d="M 52 40 L 64 28 L 76 40" stroke="white" stroke-width="5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M 76 88 L 64 100 L 52 88" stroke="white" stroke-width="5" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"/>
        </svg>
      </div>
      <h1>ZDFTranslate 设置</h1>
      <p>简洁、快速、可控的双语翻译体验</p>
    </header>

    <div class="settings-layout">
      <aside class="settings-sidebar">
        <div class="sidebar-title">设置导航</div>
        <a href="#sec-free" class="sidebar-link">免费服务</a>
        <a href="#sec-cn" class="sidebar-link">国内 AI 服务</a>
        <a href="#sec-global" class="sidebar-link">国际翻译服务</a>
        <a href="#sec-video" class="sidebar-link">视频翻译设置</a>
        <a href="#sec-style" class="sidebar-link">外观设置</a>
        <a href="#sec-excluded" class="sidebar-link">排除网站</a>
        <a href="#sec-about" class="sidebar-link">关于</a>
      </aside>

      <main class="settings-main">

      <!-- 免费服务 -->
      <section class="card" id="sec-free">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="8" width="18" height="12" rx="2"/>
              <path d="M12 8V5"/>
              <path d="M12 5C10.5 3.5 8 3.5 7 5"/>
              <path d="M12 5C13.5 3.5 16 3.5 17 5"/>
              <circle cx="12" cy="14" r="2"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">免费翻译服务</h2>
            <p class="card-subtitle">无需配置 API Key，开箱即用</p>
          </div>
        </div>

        <div class="form-group">
          <label>LibreTranslate（默认）</label>
          <p class="service-note">
            开源免费翻译服务，支持中文、英文、日文、韩文、法文、德文、西班牙文、俄文等。<br>
            无需配置，直接使用。
          </p>
        </div>
      </section>

      <!-- API 密钥设置 - 国内AI -->
      <section class="card" id="sec-cn">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="4" y="4" width="16" height="16" rx="2"/>
              <path d="M9 9h6v6H9z"/>
              <path d="M9 3v2"/>
              <path d="M15 3v2"/>
              <path d="M9 19v2"/>
              <path d="M15 19v2"/>
              <path d="M3 9h2"/>
              <path d="M3 15h2"/>
              <path d="M19 9h2"/>
              <path d="M19 15h2"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">国内 AI 服务（推荐）</h2>
            <p class="card-subtitle">配置国内 AI 服务 API 密钥，访问更稳定快速</p>
          </div>
        </div>

        <div class="form-group">
          <label>阿里云百炼 API Key</label>
          <input type="password" id="aliyunApiKey" placeholder="输入阿里云百炼 API Key">
          <a href="https://bailian.console.aliyun.com/" target="_blank">如何获取？</a>
        </div>
        <div class="form-group model-select">
          <label>模型选择</label>
          <div class="model-input-wrapper">
            <select id="aliyunModel" class="model-select-dropdown">
              <option value="">加载默认模型...</option>
            </select>
            <input type="text" id="aliyunModelCustom" class="model-custom-input" placeholder="输入自定义模型名" style="display:none;">
          </div>
          <div class="model-actions">
            <button class="refresh-models" data-service="aliyun">🔄 获取远程模型</button>
            <button class="toggle-custom-model" data-service="aliyun">✏️ 自定义</button>
          </div>
          <span class="model-status" id="aliyunStatus"></span>
        </div>

        <div class="form-group">
          <label>Kimi API Key (月之暗面)</label>
          <input type="password" id="kimiApiKey" placeholder="输入 Kimi API Key">
          <a href="https://platform.moonshot.cn/" target="_blank">如何获取？</a>
        </div>
        <div class="form-group model-select">
          <label>模型选择</label>
          <div class="model-input-wrapper">
            <select id="kimiModel" class="model-select-dropdown">
              <option value="">加载默认模型...</option>
            </select>
            <input type="text" id="kimiModelCustom" class="model-custom-input" placeholder="输入自定义模型名" style="display:none;">
          </div>
          <div class="model-actions">
            <button class="refresh-models" data-service="kimi">🔄 获取远程模型</button>
            <button class="toggle-custom-model" data-service="kimi">✏️ 自定义</button>
          </div>
          <span class="model-status" id="kimiStatus"></span>
        </div>

        <div class="form-group">
          <label>智谱清言 API Key (GLM)</label>
          <input type="password" id="zhipuApiKey" placeholder="输入智谱清言 API Key">
          <a href="https://open.bigmodel.cn/" target="_blank">如何获取？</a>
        </div>
        <div class="form-group model-select">
          <label>模型选择</label>
          <div class="model-input-wrapper">
            <select id="zhipuModel" class="model-select-dropdown">
              <option value="">加载默认模型...</option>
            </select>
            <input type="text" id="zhipuModelCustom" class="model-custom-input" placeholder="输入最新模型名，如: glm-4.7" style="display:none;">
          </div>
          <div class="model-actions">
            <button class="refresh-models" data-service="zhipu">🔄 获取远程模型</button>
            <button class="toggle-custom-model" data-service="zhipu">✏️ 自定义</button>
          </div>
          <span class="model-status" id="zhipuStatus"></span>
        </div>

        <div class="form-group">
          <label>DeepSeek API Key</label>
          <input type="password" id="deepseekApiKey" placeholder="输入 DeepSeek API Key">
          <a href="https://platform.deepseek.com/" target="_blank">如何获取？</a>
        </div>
        <div class="form-group model-select">
          <label>模型选择</label>
          <div class="model-input-wrapper">
            <select id="deepseekModel" class="model-select-dropdown">
              <option value="">加载默认模型...</option>
            </select>
            <input type="text" id="deepseekModelCustom" class="model-custom-input" placeholder="输入自定义模型名" style="display:none;">
          </div>
          <div class="model-actions">
            <button class="refresh-models" data-service="deepseek">🔄 获取远程模型</button>
            <button class="toggle-custom-model" data-service="deepseek">✏️ 自定义</button>
          </div>
          <span class="model-status" id="deepseekStatus"></span>
        </div>
      </section>

      <!-- API 密钥设置 - 国际服务 -->
      <section class="card" id="sec-global">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <path d="M2 12h20"/>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">国际翻译服务</h2>
            <p class="card-subtitle">配置国际翻译服务 API 密钥</p>
          </div>
        </div>

        <div class="form-group">
          <label>Google Translate API Key</label>
          <input type="password" id="googleApiKey" placeholder="输入 Google API Key">
          <a href="https://cloud.google.com/translate/docs/setup" target="_blank">如何获取？</a>
        </div>

        <div class="form-group">
          <label>DeepL API Key</label>
          <input type="password" id="deeplApiKey" placeholder="输入 DeepL API Key">
          <a href="https://www.deepl.com/pro-api" target="_blank">如何获取？</a>
        </div>

        <div class="form-group">
          <label>OpenAI API Key</label>
          <input type="password" id="openaiApiKey" placeholder="输入 OpenAI API Key">
          <a href="https://platform.openai.com/api-keys" target="_blank">如何获取？</a>
        </div>

        <div class="form-group model-select">
          <label>模型选择</label>
          <div class="model-input-wrapper">
            <select id="openaiModel" class="model-select-dropdown">
              <option value="">加载默认模型...</option>
            </select>
            <input type="text" id="openaiModelCustom" class="model-custom-input" placeholder="输入自定义模型名" style="display:none;">
          </div>
          <div class="model-actions">
            <button class="refresh-models" data-service="openai">🔄 获取远程模型</button>
            <button class="toggle-custom-model" data-service="openai">✏️ 自定义</button>
          </div>
          <span class="model-status" id="openaiStatus"></span>
        </div>
      </section>

      <!-- 视频翻译设置 -->
      <section class="card" id="sec-video">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="5 3 19 12 5 21 5 3"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">视频翻译设置</h2>
            <p class="card-subtitle">YouTube 等视频网站的字幕增强</p>
          </div>
        </div>

        <div class="form-group checkbox">
          <label>
            <input type="checkbox" id="autoTranslateYouTube">
            访问 YouTube 时自动开启双语字幕
          </label>
        </div>

        <div class="form-group checkbox">
          <label>
            <input type="checkbox" id="autoEnableYouTubeCC">
            自动开启 YouTube 自带字幕 (CC) 并尝试切换为英语
          </label>
          <p class="hint">若视频没有字幕，此选项可能无效。</p>
        </div>
      </section>

      <!-- 外观设置 -->
      <section class="card" id="sec-style">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="13.5" cy="6.5" r=".5"/>
              <circle cx="17.5" cy="10.5" r=".5"/>
              <circle cx="8.5" cy="7.5" r=".5"/>
              <circle cx="6.5" cy="12.5" r=".5"/>
              <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">外观设置</h2>
            <p class="card-subtitle">外观设置个性化</p>
          </div>
        </div>

        <div class="form-group">
          <label>译文颜色</label>
          <input type="color" id="translationColor" value="#111111">
        </div>

        <div class="form-group">
          <label>译文字号</label>
          <select id="translationSize">
            <option value="0.85em">小</option>
            <option value="0.95em" selected>中</option>
            <option value="1em">大</option>
          </select>
        </div>

        <div class="form-group">
          <label>行间距</label>
          <select id="lineSpacing">
            <option value="1.4">紧凑</option>
            <option value="1.6" selected>舒适</option>
            <option value="1.8">宽松</option>
          </select>
        </div>

        <div class="form-group checkbox">
          <label>
            <input type="checkbox" id="backgroundHighlight">
            高亮译文背景
          </label>
        </div>
      </section>

      <!-- 排除网站 -->
      <section class="card" id="sec-excluded">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <path d="m4.9 4.9 14.2 14.2"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">排除网站</h2>
            <p class="card-subtitle">以下网站将不会触发"整页翻译"（每行一个域名）</p>
          </div>
        </div>
        <textarea id="excludedSites" rows="5" placeholder="example.com&#10;another-site.org"></textarea>
        <p class="hint" style="margin-top:8px;">提示：仅影响悬浮按钮触发的整页翻译，不影响右键划词翻译。</p>
      </section>

      <!-- 关于 -->
      <section class="card" id="sec-about">
        <div class="card-header">
          <div class="card-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 16v-4"/>
              <path d="M12 8h.01"/>
            </svg>
          </div>
          <div>
            <h2 class="card-title">关于</h2>
            <p class="card-subtitle">版本: <span id="appVersion">-</span></p>
          </div>
        </div>
        <p>ZDFTranslate - 简单双语翻译插件</p>
      </section>
    </main>
    </div>

    <footer>
      <button id="saveBtn" class="btn-primary">保存设置</button>
      <button id="resetBtn" class="btn-secondary">恢复默认</button>
      <span id="saveStatus"></span>
    </footer>
  </div>

  <script src="options.js"></script>
</body>
</html>
